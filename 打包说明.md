# MEMEFinder 打包说明

本文档说明如何将 MEMEFinder 项目打包为可执行程序，供用户开箱即用。

## 快速打包

### 方法一：一键打包（推荐）

直接双击运行 `一键打包.bat`，脚本会自动：
1. 检查 Python 环境
2. 检查并安装 PyInstaller（如需要）
3. 执行打包流程
4. 创建发布包

### 方法二：手动打包

1. 确保已安装依赖：
   ```bash
   pip install -r requirements.txt
   pip install pyinstaller
   ```

2. 运行打包脚本：
   ```bash
   python build_release.py
   ```

   或使用批处理文件：
   ```bash
   打包发布版.bat
   ```

## 打包输出

打包完成后，会在 `dist/` 目录下生成：

```
dist/
├── MEMEFinder/                    # 可执行程序目录
│   ├── MEMEFinder.exe            # 主程序
│   ├── _internal/                # 依赖文件
│   ├── src/                      # 源代码
│   ├── 启动MEMEFinder.bat        # 启动脚本
│   ├── 使用说明.txt              # 用户使用说明
│   ├── README.txt                # 项目说明
│   ├── LICENSE.txt               # 许可证
│   ├── logs/                     # 日志目录（空）
│   └── models/                   # 模型目录（空）
│
└── MEMEFinder-v1.0.0-Windows-x64.zip  # 发布包
```

## 打包配置

### PyInstaller 配置

项目使用 `MEMEFinder.spec` 文件配置 PyInstaller，主要配置包括：

- **数据文件**：包含 `src/`、`README.md`、`LICENSE`、`paddlex_patch.py`
- **隐藏导入**：包含所有必需的 Python 模块
- **依赖收集**：自动收集 PaddleOCR、PaddleNLP 等所有依赖

### 打包脚本功能

`build_release.py` 脚本提供以下功能：

1. **清理旧文件**：自动清理 `build/`、`dist/` 目录和旧的 spec 文件
2. **打包程序**：使用 PyInstaller 打包为 Windows 可执行文件
3. **检查输出**：验证打包结果并显示文件大小
4. **创建发布包**：
   - 复制 README 和 LICENSE
   - 创建启动脚本
   - 创建用户使用说明
   - 创建必要的目录
   - 打包为 ZIP 文件

## 用户使用流程

打包后的程序用户可以：

1. **解压 ZIP 包**到任意位置
2. **首次运行**：
   - 双击 `启动MEMEFinder.bat` 或 `MEMEFinder.exe`
   - 程序会自动下载 AI 模型（需要网络，约 5-15 分钟）
3. **日常使用**：
   - 直接运行程序
   - 所有功能开箱即用

## 系统要求

- **打包环境**：
  - Python 3.8+
  - PyInstaller
  - 所有项目依赖

- **运行环境**（用户）：
  - Windows 10/11 64位
  - 无需安装 Python
  - 首次需要网络连接

## 注意事项

1. **模型文件**：首次运行需要下载模型，建议在打包说明中提醒用户
2. **文件大小**：打包后的程序约 200-300 MB（不含模型）
3. **杀毒软件**：某些杀毒软件可能误报，建议添加白名单
4. **路径问题**：确保程序放在固定位置，避免路径变化导致问题

## 测试清单

打包后请测试：

- [ ] 程序可以正常启动
- [ ] GUI 界面正常显示
- [ ] 可以添加图源文件夹
- [ ] 可以扫描图片
- [ ] OCR 功能正常（需要模型）
- [ ] 搜索功能正常
- [ ] 日志文件正常生成

## 发布流程

1. 运行打包脚本生成发布包
2. 测试可执行文件的所有功能
3. 创建 GitHub Release
4. 上传 ZIP 包
5. 编写 Release Notes

## 故障排除

### 打包失败

- 检查 Python 和 PyInstaller 版本
- 确保所有依赖已安装
- 查看错误日志

### 程序无法运行

- 检查系统是否为 Windows 10/11 64位
- 检查是否有杀毒软件拦截
- 查看 `logs/` 目录中的日志文件

### 缺少依赖

- 检查 `MEMEFinder.spec` 中的隐藏导入配置
- 使用 `--collect-all` 收集所有依赖

## 更多信息

- 项目文档：`docs/` 目录
- 用户指南：`docs/USER_GUIDE.md`
- 发布指南：`docs/RELEASE_GUIDE.md`


