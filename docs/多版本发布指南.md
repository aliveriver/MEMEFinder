# MEMEFinder 多版本发布指南

## 📦 版本说明

为了适配不同用户的系统环境，MEMEFinder 提供了3个版本：

### 1. CPU通用版 (推荐)
- **文件名**: `MEMEFinder_cpu.zip`
- **适用人群**: 所有用户
- **优点**: 
  - ✅ 兼容性最好，无需GPU
  - ✅ 稳定可靠，不会闪退
  - ✅ 体积较小
- **缺点**:
  - ⚠️ 识别速度较慢 (约2-3秒/图片)
- **推荐给**:
  - 没有NVIDIA显卡的用户
  - 追求稳定性的用户
  - 对速度要求不高的用户

### 2. GPU加速版 - CUDA 11.x
- **文件名**: `MEMEFinder_gpu-cuda11.zip`
- **适用人群**: CUDA 11.x 用户
- **优点**:
  - ✅ GPU加速，识别速度快 (约0.5-1秒/图片)
  - ✅ 性能提升3-5倍
- **缺点**:
  - ⚠️ 需要NVIDIA显卡
  - ⚠️ 需要CUDA 11.x运行时
  - ⚠️ 体积较大（包含CUDA库）
- **推荐给**:
  - GTX 10系列 (1050, 1060, 1070, 1080...)
  - GTX 16系列 (1650, 1660...)
  - RTX 20系列 (2060, 2070, 2080...)
  - 旧驱动版本用户

### 3. GPU加速版 - CUDA 12.x
- **文件名**: `MEMEFinder_gpu-cuda12.zip`
- **适用人群**: CUDA 12.x 用户
- **优点**:
  - ✅ GPU加速，识别速度最快
  - ✅ 支持最新GPU特性
  - ✅ 性能最优
- **缺点**:
  - ⚠️ 需要NVIDIA显卡
  - ⚠️ 需要CUDA 12.x运行时
  - ⚠️ 体积最大
- **推荐给**:
  - RTX 30系列 (3060, 3070, 3080, 3090...)
  - RTX 40系列 (4060, 4070, 4080, 4090...)
  - 最新驱动版本用户

---

## 🔍 如何选择版本？

### 方法1: 自动检测（推荐）

运行版本检测工具：
```bash
python scripts/recommend_version.py
```

工具会自动检测您的系统并推荐合适的版本。

### 方法2: 手动检查

#### 检查是否有NVIDIA显卡

1. 打开命令提示符（CMD）
2. 输入: `nvidia-smi`
3. 如果显示显卡信息，说明有NVIDIA显卡
4. 查看右上角 `CUDA Version: xx.x`

**示例输出**:
```
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 536.67       Driver Version: 536.67       CUDA Version: 12.2     |
|-------------------------------+----------------------+----------------------+
```

#### 根据CUDA版本选择

- **无法运行 nvidia-smi** → 选择 CPU通用版
- **CUDA Version: 11.x** → 选择 GPU-CUDA11版
- **CUDA Version: 12.x** → 选择 GPU-CUDA12版

---

## 📥 下载和安装

### 1. 下载对应版本

从 [Releases](https://github.com/yourusername/MEMEFinder/releases) 页面下载对应的版本：

- `MEMEFinder_cpu.zip` - CPU通用版
- `MEMEFinder_gpu-cuda11.zip` - GPU-CUDA11版
- `MEMEFinder_gpu-cuda12.zip` - GPU-CUDA12版

### 2. 解压到任意目录

建议解压到: `C:\Program Files\MEMEFinder\` 或 `D:\Software\MEMEFinder\`

### 3. 运行程序

双击运行: `MEMEFinder_xxx.exe`

程序会自动打开浏览器访问: `http://localhost:5000`

---

## 🔧 常见问题

### Q1: GPU版本闪退/无法启动？

**解决方法**:

1. **使用CPU模式启动**
   - 运行 `启动_CPU模式.bat`（如果存在）
   - 或下载使用CPU通用版

2. **检查CUDA运行时**
   - 确认已安装NVIDIA驱动
   - 尝试更新到最新驱动版本

3. **查看日志**
   - 查看 `logs` 目录下的日志文件
   - 查找错误信息

### Q2: 如何确认我下载的版本？

运行程序后，查看窗口标题或日志，会显示版本信息。

### Q3: GPU版本比CPU版本慢？

可能原因：
- GPU初始化失败，已自动切换到CPU模式
- 查看日志确认是否使用了GPU
- 尝试使用CPU版本（更稳定）

### Q4: 能否在一台电脑上使用多个版本？

可以！不同版本可以并存，但同时只能运行一个。

### Q5: GPU版本体积为什么这么大？

GPU版本包含了CUDA运行时库和相关DLL文件，以确保在没有安装CUDA的系统上也能运行。

---

## 🎯 性能对比

| 版本 | 识别速度 | 内存占用 | 稳定性 | 体积 |
|------|---------|---------|--------|------|
| CPU通用版 | 2-3秒/图 | ~300MB | ⭐⭐⭐⭐⭐ | ~150MB |
| GPU-CUDA11 | 0.5-1秒/图 | ~500MB | ⭐⭐⭐⭐ | ~400MB |
| GPU-CUDA12 | 0.5-1秒/图 | ~500MB | ⭐⭐⭐⭐ | ~450MB |

*测试环境: RTX 3060, 16GB RAM, 1000张图片*

---

## 📊 版本兼容性矩阵

| 显卡系列 | CPU版本 | CUDA11版本 | CUDA12版本 | 推荐 |
|---------|---------|-----------|-----------|------|
| 无NVIDIA显卡 | ✅ | ❌ | ❌ | CPU |
| GTX 10系列 | ✅ | ✅ | ⚠️ | CUDA11 |
| GTX 16系列 | ✅ | ✅ | ⚠️ | CUDA11 |
| RTX 20系列 | ✅ | ✅ | ✅ | CUDA11/12 |
| RTX 30系列 | ✅ | ✅ | ✅ | CUDA12 |
| RTX 40系列 | ✅ | ⚠️ | ✅ | CUDA12 |

**说明**:
- ✅ 完全支持
- ⚠️ 部分支持（取决于驱动版本）
- ❌ 不支持

---

## 🛠️ 高级功能

### 强制使用CPU模式

即使下载的是GPU版本，也可以强制使用CPU模式：

**方法1**: 使用启动脚本
```batch
启动_CPU模式.bat
```

**方法2**: 设置环境变量
```batch
set FORCE_CPU_MODE=1
MEMEFinder_xxx.exe
```

### 查看GPU使用情况

运行程序时，查看日志文件:
```
logs/memefinder_YYYYMMDD.log
```

搜索关键词:
- `GPU初始化成功` - GPU正常工作
- `切换到CPU模式` - GPU失败，已降级
- `CUDA` - CUDA相关信息

---

## 📝 构建说明（开发者）

### 构建单个版本

```bash
# CPU版本
python scripts/build_multi_version.py --version cpu

# GPU-CUDA11版本
python scripts/build_multi_version.py --version gpu-cuda11

# GPU-CUDA12版本
python scripts/build_multi_version.py --version gpu-cuda12
```

### 构建所有版本

```bash
python scripts/build_multi_version.py --all
```

或使用批处理脚本:
```batch
scripts\打包所有版本.bat
```

### 输出位置

所有构建版本保存在: `releases/`

---

## 🚀 发布流程

1. **构建所有版本**
   ```bash
   python scripts/build_multi_version.py --all
   ```

2. **测试各个版本**
   - 在不同环境测试CPU版本
   - 在CUDA 11环境测试GPU-CUDA11版本
   - 在CUDA 12环境测试GPU-CUDA12版本

3. **打包压缩**
   ```bash
   cd releases
   # 分别压缩各个版本
   ```

4. **创建Release**
   - 上传到GitHub Releases
   - 添加版本说明和更新日志
   - 提供版本选择指南

5. **更新文档**
   - 更新 README.md 添加下载链接
   - 更新版本选择说明

---

## 💡 建议

1. **首次使用**: 建议先下载CPU通用版，确保程序能正常运行
2. **性能需求**: 如需处理大量图片，且有NVIDIA显卡，使用GPU版本
3. **稳定优先**: 追求稳定性，使用CPU版本
4. **遇到问题**: GPU版本有问题，立即切换到CPU版本

---

## 📞 技术支持

如有问题，请：
1. 查看日志文件: `logs/memefinder_YYYYMMDD.log`
2. 运行诊断工具: `python scripts/diagnose_gpu.py`
3. 查看文档: `docs/` 目录
4. 提交Issue: [GitHub Issues](https://github.com/yourusername/MEMEFinder/issues)

---

## 📄 许可证

本项目采用 MIT 许可证。详见 [LICENSE](LICENSE) 文件。
